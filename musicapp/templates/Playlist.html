{% extends "base.html" %}
{% load static %}


{% block extra_css %}
    <link rel="stylesheet" href="{% static '/musicapp/сss/Albums.css' %}">
    <link rel="stylesheet" href="{% static '/musicapp/сss/Playlist.css' %}">
{% endblock extra_css%}

{% block content %}
<!-- music-player-container --><!-- music-player-container -->
 <!-- music-player-container --><!-- music-player-container -->
  <!-- music-player-container --><!-- music-player-container -->
<div class="music-player-container">
    <audio id="audio-player">
        <source src="https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3" type="audio/mpeg">
    </audio>
    <div class="album-cover">
        <img src="{% static '/musicapp/images/Rectangle 1.png' %}" alt="Song Cover">
    </div>
    <div class="music-info">
        <h3>Song Name</h3>
        <p>Artist Name</p>
    </div>
    <div class="controls">
        <button class="prev">◀</button>
        <button class="play-pause" onclick="togglePlayPause()">▶</button>
        <button class="next">▶</button>
    </div>
    <div class="progress-bar" id="progress-bar">
        <div class="progress" id="progress"></div>
    </div>
    <div class="time-stamps">
        <span id="current-time">0:00</span>
        <span id="total-duration">2:14</span>
    </div>
</div>






<!-- Trending Songs Section -->


<!-- Table for Trending Songs -->
<div class="song-table-container">
    <table class="song-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Release Date</th>
                <th>Album</th>
                <th>Time</th>
                <th>Play</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood.png' %}" alt="Forcecore" class="song-cover"> Forcecore
                </td>
                <td>Nov 3, 2023</td>
                <td>Hard to Imagine</td>
                <td class="song-time">3:26</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 2.png' %}" alt="Skyfall Beats" class="song-cover"> Skyfall Beats
                </td>
                <td>Oct 26, 2023</td>
                <td>Nightmares</td>
                <td class="song-time">3:20</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 3.png' %}" alt="Greedy" class="song-cover"> Greedy
                </td>
                <td>Nov 30, 2023</td>
                <td>Greedy</td>
                <td class="song-time">3:10</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 4.png' %}" alt="Lovin On Me" class="song-cover"> Lovin On Me
                </td>
                <td>Dec 15, 2023</td>
                <td>Lovin On Me</td>
                <td class="song-time">2:48</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 7 (8).png' %}" alt="Pain the Town Red" class="song-cover"> Pain the Town Red
                </td>
                <td>Dec 29, 2023</td>
                <td>Pain The Town Red</td>
                <td class="song-time">3:02</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
          
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 6.png' %}" alt="Forcecore" class="song-cover"> Forcecore
                </td>
                <td>Nov 3, 2023</td>
                <td>Hard to Imagine</td>
                <td class="song-time">3:26</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 7 (9).png' %}" alt="Skyfall Beats" class="song-cover"> Skyfall Beats
                </td>
                <td>Oct 26, 2023</td>
                <td>Nightmares</td>
                <td class="song-time">3:20</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 7 (10).png' %}" alt="Greedy" class="song-cover"> Greedy
                </td>
                <td>Nov 30, 2023</td>
                <td>Greedy</td>
                <td class="song-time">3:10</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>

            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 7 (11).png' %}" alt="Skyfall Beats" class="song-cover"> Skyfall Beats
                </td>
                <td>Oct 26, 2023</td>
                <td>Nightmares</td>
                <td class="song-time">3:20</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 2.png' %}" alt="Skyfall Beats" class="song-cover"> Skyfall Beats
                </td>
                <td>Oct 26, 2023</td>
                <td>Nightmares</td>
                <td class="song-time">3:20</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
            <tr>
                <td>
                    <!-- Фото для кожного треку -->
                    <img src="{% static '/musicapp/images/The_Neighbourhood_-_The_Neighbourhood 3.png' %}" alt="Greedy" class="song-cover"> Greedy
                </td>
                <td>Nov 30, 2023</td>
                <td>Greedy</td>
                <td class="song-time">3:10</td>
                <td>3:26 <span class="heart-icon">❤</span> <span class="play-icon" onclick="playSong(this, 'https://muzem.net/uploads/music/2023/10/Prada_Cola_Ian_Asher_TikTok_Remix.mp3')">▶</span></td>
            </tr>
        </tbody>
    </table>
</div>


{% endblock content%}

{% block extra_scripts %}

<script>

  const audioPlayer = document.getElementById('audio-player');
  const playPauseBtn = document.querySelector('.play-pause');
  const progressBar = document.getElementById('progress-bar');
  const progress = document.getElementById('progress');
  const currentTimeElement = document.getElementById('current-time');
  const totalDurationElement = document.getElementById('total-duration');
  let currentSongElement = null;

  function playSong(element, songUrl) {
      if (currentSongElement === element) {
          togglePlayPause();
          return;
        }

      audioPlayer.src = songUrl;
      audioPlayer.play();
      playPauseBtn.innerHTML = "❚❚"; // Pause symbol
      updateSongHighlight(element);
      currentSongElement = element;
  }

  function togglePlayPause() {
      if (audioPlayer.paused) {
          audioPlayer.play();
          playPauseBtn.innerHTML = "❚❚"; // Pause symbol
          if (currentSongElement) {
              currentSongElement.innerHTML = "❚❚";
          }
      } else {
          audioPlayer.pause();
          playPauseBtn.innerHTML = "▶";
          if (currentSongElement) {
              currentSongElement.innerHTML = "▶";
          }
      }
  }
  // Update progress bar as song plays
  audioPlayer.addEventListener("timeupdate", () => {
      if (!audioPlayer.duration) return;

      const progressPercentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
      progress.style.width = `${progressPercentage}%`;

      // Update current time display
      const currentMinutes = Math.floor(audioPlayer.currentTime / 60);
      const currentSeconds = Math.floor(audioPlayer.currentTime % 60);
      currentTimeElement.textContent = `${currentMinutes}:${currentSeconds.toString().padStart(2, "0")}`;

      // Set total duration when available
      if (!totalDurationElement.textContent.includes(":") && !isNaN(audioPlayer.duration)) {
          const totalMinutes = Math.floor(audioPlayer.duration / 60);
          const totalSeconds = Math.floor(audioPlayer.duration % 60);
          totalDurationElement.textContent = `${totalMinutes}:${totalSeconds.toString().padStart(2, "0")}`;
      }
  });

  progressBar.addEventListener("click", (e) => {
      if (!audioPlayer.duration) return;

      const progressBarWidth = progressBar.clientWidth;
      const clickX = e.offsetX;
      audioPlayer.currentTime = (clickX / progressBarWidth) * audioPlayer.duration;

      audioPlayer.currentTime = (clickX / progressBarWidth) * audioPlayer.duration;
  });


  function updateSongHighlight(element) {
      if (currentSongElement) {
          currentSongElement.innerHTML = "▶";
      }
      element.innerHTML = "❚❚";
  }

  audioPlayer.addEventListener("ended", () => {
    playPauseBtn.innerHTML = "▶"; // Change back to play icon when song ends
    if (currentSongElement) {
        currentSongElement.innerHTML = "▶"; // Reset the song element icon
    }
});

  const prevBtn = document.querySelector('.prev');
  const nextBtn = document.querySelector('.next');

  prevBtn.addEventListener("click", () => {
      audioPlayer.currentTime = Math.max(0, audioPlayer.currentTime - 10); // Go back 10 seconds
  });

  nextBtn.addEventListener("click", () => {
      audioPlayer.currentTime = Math.min(audioPlayer.duration, audioPlayer.currentTime + 10); // Skip forward 10 seconds
  });

</script>
{% endblock extra_scripts%}

